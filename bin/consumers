#!/usr/bin/env ruby

require File.expand_path("../../config/environment", __FILE__)

trap('INT') {
  Thread.new do
    Evrone::Common::AMQP.shutdown
    Evrone::Common::AMQP::Supervisor::Threaded.shutdown
  end
}

Evrone::Common::AMQP::Supervisor::Threaded.build(
  FetchBuildConsumer  => 2,
  BuildStatusConsumer => 2,
  JobStatusConsumer   => 2,
  JobLogsConsumer     => 4,
  WsPublishConsumer   => 4,
).run
