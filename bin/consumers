#!/usr/bin/env ruby

require File.expand_path("../../config/environment", __FILE__)

trap('INT') {
  Thread.new do
    Vx::Common::AMQP.shutdown
    Vx::Common::AMQP::Supervisor::Threaded.shutdown
  end
}

Vx::Common::AMQP::Supervisor::Threaded.build(
  FetchBuildConsumer   => 2,
  BuildNotifyConsumer  => 1,
  BuildStatusConsumer  => 1,
  JobStatusConsumer    => 1,
  JobLogsConsumer      => 4,
  WsPublishConsumer    => 4,
).run
