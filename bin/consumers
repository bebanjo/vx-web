#!/usr/bin/env ruby

ENV['VX_COMPONENT_NAME'] = 'consumers'

require File.expand_path("../../config/environment", __FILE__)

trap('INT') {
  Thread.new do
    Vx::Common::AMQP.shutdown
    Vx::Common::AMQP::Supervisor::Threaded.shutdown
  end
}

Vx::Common::AMQP::Supervisor::Threaded.build(
  BuildNotifyConsumer  => 1,
  JobStatusConsumer    => 1,
  JobLogsConsumer      => 1,
  PayloadConsumer      => 1,
).run
